# ๐ฏ ุชุญุณููุงุช ูููุฐุฌ Isolation Forest

## ุงููุดููุฉ ุงูุฃุตููุฉ
ุงููููุฐุฌ ูู ููู ูุฑุตุฏ ุจุตูุงุช ุงูุชูุฏูุฏ (Threat Fingerprints) ุฃุซูุงุก ูุญุงูุงุฉ ุงููุฌูู.

## ุงูุญููู ุงููุทุจูุฉ

### 1. โ ุชุญุณูู Notebook ุงูุชุฏุฑูุจ (`ml/notebooks/train_isoforest.ipynb`)

#### ุงูุชุบููุฑุงุช ุงูุฑุฆูุณูุฉ:
- **ุชุฏุฑูุจ ุนูู ุงูุจูุงูุงุช ุงูุทุจูุนูุฉ ููุท**: ุงููููุฐุฌ ุงูุขู ููุฏุฑูุจ ุนูู 1000 ุฌูุณุฉ ุทุจูุนูุฉ ููุท
- **ุจูุงูุงุช ุงุฎุชุจุงุฑ ูููุตูุฉ**: 50 ุฌูุณุฉ ูุฌูููุฉ ููุงุฎุชุจุงุฑ ููุท (ูุง ุชูุณุชุฎุฏู ูู ุงูุชุฏุฑูุจ)
- **ุชุญุณูู ุชูููุฏ ุงูุจูุงูุงุช**:
  - ุงูุจูุงูุงุช ุงูุทุจูุนูุฉ: 1-15 ุญุฏุซุ 0-2 ูุญุงููุฉ ุชุญุฏูุซุ 0.1-1.5 ุญุฏุซ/ุฏูููุฉ
  - ุงูุจูุงูุงุช ุงููุฌูููุฉ: 15-40 ุญุฏุซุ 5-15 ูุญุงููุฉ ุชุญุฏูุซุ 5-20 ุญุฏุซ/ุฏูููุฉ
- **ุงูุชุญูู ูู ุงููุชุงุฆุฌ**: ูุชุญูู ุฃู ูุชูุณุท ูุชุงุฆุฌ ุงููุฌูุงุช ุณุงูุจ ุจูุถูุญ (< -0.15)

#### ุงููุฎุฑุฌุงุช ุงูุฌุฏูุฏุฉ:
- ุฅุญุตุงุฆูุงุช ููุตูุฉ ุนู ูุชุงุฆุฌ Normal vs Attack
- ููู ูุฑุฌุนูุฉ (MAX_NORMAL_SCORE, MIN_ANOMALY_SCORE) ููุงุณุชุฎุฏุงู ูู engine.py
- ุงุฎุชุจุงุฑ Risk Score Conversion

### 2. โ ุชุญุณูู ููุทู ุงููุดู ูู `engine.py`

#### ุฏุงูุฉ `get_risk_score()` ุงูุฌุฏูุฏุฉ:
```python
def get_risk_score(raw_score: float) -> int:
    """
    ุชุญููู Isolation Forest decision score ุฅูู Risk Score (0-100)
    
    ุงูุตูุบุฉ:
    RiskScore = max(0, min(100, int(100 ร (1.0 - (raw_score - MIN_ANOMALY_SCORE) / (MAX_NORMAL_SCORE - MIN_ANOMALY_SCORE)))))
    """
```

#### ุงูููู ุงููุฑุฌุนูุฉ:
- `MAX_NORMAL_SCORE = 0.1` (ุฃูุตู ูููุฉ ููุณููู ุงูุทุจูุนู)
- `MIN_ANOMALY_SCORE = -0.2` (ุฃุฏูู ูููุฉ ููุณููู ุงููุดุจูู)

#### ููู ุชุนูู ุงูุตูุบุฉ:
1. **raw_score ุณุงูุจ** (ูุซู -0.15) โ **Risk Score ุนุงูู** (ูุซู 83)
2. **raw_score ููุฌุจ** (ูุซู 0.05) โ **Risk Score ููุฎูุถ** (ูุซู 33)

### 3. โ ุฅุถุงูุฉ Debugging Prints

#### ุงููุฎุฑุฌุงุช ุงูุฌุฏูุฏุฉ ูู `process_event()`:
```
๐ [DEBUG] Event Processing:
   User ID: user-1234...
   Device ID: device-56...
   Event Type: update_mobile_attempt
   Features: total_events=20, update_attempts=15, events_per_min=10.00
   Raw Decision Score: -0.150
   Prediction: Anomaly
   Risk Score: 83/100
   Threshold: ๐จ THREAT DETECTED
   โ Threat Fingerprint created: fp-abc123def456
```

## ุฎุทูุงุช ุฅุนุงุฏุฉ ุงูุชุฏุฑูุจ

### 1. ุดุบูู Notebook ุงูุชุฏุฑูุจ:
```python
# ูู ml/notebooks/train_isoforest.ipynb
# ุดุบูู ุฌููุน ุงูุฎูุงูุง ุจุงูุชุฑุชูุจ
```

### 2. ุชุญูู ูู ุงููุชุงุฆุฌ:
- ูุฌุจ ุฃู ูููู ูุชูุณุท Attack Scores < -0.15
- ูุฌุจ ุฃู ูููู Risk Score ูููุฌูุงุช >= 80

### 3. ุงุญูุธ ุงููููุฐุฌ:
- ุณูุชู ุญูุธู ุชููุงุฆูุงู ูู `ml/models/isoforest_absher.pkl`

### 4. ุงุฎุชุจุฑ ุงููุธุงู:
```bash
# ุดุบูู ุงูุณูุฑูุฑ
python backend/main.py

# ุงูุชุญ Health Portal ูุงุฎุชุจุฑ Attack Simulation
```

## ุงูุชุญูู ูู ุงููุฌุงุญ

### โ ุนูุงูุงุช ุงููุฌุงุญ:
1. **ูู Notebook**: Attack scores ุณุงูุจุฉ ุจูุถูุญ (< -0.15)
2. **ูู Terminal**: ุธููุฑ ุฑุณุงุฆู DEBUG ุนูุฏ ูุนุงูุฌุฉ ุงูุฃุญุฏุงุซ
3. **ูู Dashboard**: ุธููุฑ Threat Fingerprints ุจุนุฏ ูุญุงูุงุฉ ุงููุฌูู
4. **Risk Score**: >= 80 ูููุฌูุงุชุ < 80 ููุณููู ุงูุทุจูุนู

### โ๏ธ ุฅุฐุง ูู ูุนูู:
1. ุชุญูู ูู ุฃู ุงููููุฐุฌ ุชู ุญูุธู ูู `ml/models/isoforest_absher.pkl`
2. ุชุญูู ูู ุฑุณุงุฆู DEBUG ูู Terminal
3. ุชุฃูุฏ ูู ุฃู ุงูุจูุงูุงุช ุงููุฌูููุฉ ููุง:
   - total_events >= 15
   - update_mobile_attempt_count >= 5
   - events_per_minute >= 5.0

## ุงูุตูุบุฉ ุงูุฑูุงุถูุฉ

### ุชุญููู Decision Score ุฅูู Risk Score:

```
normalized = (raw_score - MIN_ANOMALY_SCORE) / (MAX_NORMAL_SCORE - MIN_ANOMALY_SCORE)
risk_score = 100 ร (1.0 - normalized)
risk_score = max(0, min(100, int(risk_score)))
```

### ุฃูุซูุฉ:

| Raw Score | Normalized | Risk Score | ุงูุชูุณูุฑ |
|-----------|------------|------------|---------|
| -0.20     | 0.0        | 100        | ูุฌูู ุดุฏูุฏ |
| -0.15     | 0.17       | 83         | ูุฌูู (ูููุชุดู) |
| -0.10     | 0.33       | 67         | ูุดุจูู |
| 0.0       | 0.67       | 33         | ุทุจูุนู |
| 0.1       | 1.0        | 0          | ุทุจูุนู ุฌุฏุงู |

## ููุงุญุธุงุช ูููุฉ

1. **Isolation Forest ูุฌุจ ุฃู ููุฏุฑูุจ ุนูู Normal ููุท**: ูุฐุง ูู ุงููุจุฏุฃ ุงูุฃุณุงุณู
2. **ุงูููู ุงููุฑุฌุนูุฉ**: ูุฌุจ ุฃู ุชุชุทุงุจู ูุน ูุชุงุฆุฌ ุงูุชุฏุฑูุจ
3. **Debugging**: ูููู ุฅููุงู Debug prints ูุงุญูุงู ูู ุงูุฅูุชุงุฌ

---

**ุชู ุงูุชุญุฏูุซ ุจูุฌุงุญ! ๐**

